# Detecting-Troll-Behavior-via-Inverse-Reinforcement-Learning
Script for the implementation of the approach presented in "Detecting Troll Behavior via Inverse Reinforcement Learning: A Case Study of Russian Trolls in the 2016 US Election" by Luca Luceri, Silvia Giordano, Emilio Ferrara.

This code allows to:
1) estimate trolls' and generic users' incentives (i.e., rewards) via Inverse Reinforcement Learning (IRL) by launching "main_IRL.py".
2) classify trolls and users based on the rewards estimated with "main_IRL.py" by running "classifier.py".

In particular, "main_IRL.py" estimate trolls' (resp. users') rewards in Twitter via the following IRL approaches (implemented by Matthew Alger, 2015):
- Maximum Entropy IRL (Ziebart et al., 2008)
- Deep Maximum Entropy IRL (Wulfmeier et al., 2015)

You can select one of the two approaches by simply commenting/uncommenting line 127/128 in "main_IRL.py".
The same code can be utilized both for trolls and generic users.
For our convenience, we show here only the script that utilize trolls-related tweets to output trolls' estimated rewards.
To adapt it to non-troll accounts (i.e., generic users), you only need to give as input generic users-related tweets.

Trolls-related (resp. users-related) tweets are tweets where troll (resp. users) accounts have been actively or passively involved.

The former class (actively involved tweets) is used to create the ACTIONS of the IRL problem and includes:
- original tweets generated by trolls (resp. users)
- retweets generated by trolls (resp. users)
- replies generated by trolls (resp. users)
- mentions generated by trolls (resp. users)

The latter class (passively involved tweets) is used to create the STATES of the IRL problem and includes:
- retweets of trolls' (resp. users) generated content
- replies to trolls' (resp. users) generated content
- tweets where trolls (resp. users) were mentioned

Each of these seven categories has to be grouped in a different csv file, which will be used as an input for "main_IRL.py".
Each csv file should include the following columns:

retweet_count,favorite_count,lang,hashtags,user_mentions,quoted_status_id,user_id,user_screen_name,
rt_id,rt_coordinates,rt_created_at,rt_in_reply_to_status_id,rt_in_reply_to_user_id,rt_lang,rt_favourite_count,rt_user_id,rt_user_screen_name,rt_user_followers_count,rt_user_friends_count,rt_user_favourites_count

- screen_name = screen_name of the tweet author 
- text*	
- created_at
- id_str
- user_statuses_count = statuses_count of the author (i.e., screen_name)
- user_followers_count*	= followers_count of the author (i.e., screen_name)
- user_friends_count* = friends_count of the author (i.e., screen_name)
- user_favourites_count* = favourites_count of the author (i.e., screen_name)
- user_retweeted = screen_name of the creator of the original tweet that has been retweeted by screen_name (if the tweet is not a retweet this field can be set to NaN)
- retweet_id_str = id_str of the original tweet that has been retweeted by screen_name (if the tweet is not a retweet this field can be set to NaN)
- retweet_count (if the tweet is not a retweet this field can be set to NaN)
- retweet_favorite_count = favorite_count of the retweet (if the tweet is not a retweet this field can be set to NaN)
- retweet_reply_count = reply_count of the retweet (if the tweet is not a retweet this field can be set to NaN)
- user_retweeted_statuses_count = statuses_count of the retweeted user (i.e., user_retweeted)
- user_retweeted_followers* = followers_count of the retweeted user (i.e., user_retweeted)
- user_retweeted_friends* = friends_count of the retweeted user (i.e., user_retweeted)
- user_retweeted_favourites_count* = favourites_count of the retweeted user (i.e., user_retweeted)
- mention = screen_name of the mentioned user (this field can be set to NaN if the tweet does not have mentions)
- in_reply_to_screen_name = screen_name of the user that received a reply (if the tweet is not a reply this field can be set to NaN)
- in_reply_to_status_id_str = id_str of the tweet that received a reply (if the tweet is not a reply this field can be set to NaN)	


Finally, "main_IRL.py" outputs the estimated rewards in a csv file named "df_results_trolls_IRL.csv". 
You need to change the name of the output file when you run the script for generic users.
An example of the output file is "estimated_rewards_example.csv".


*Column not needed to be filled for the current implementation. You can fill the column with a random value or leave it empty, if you do not have this data. These columns will be used in the upcoming update of the code.
